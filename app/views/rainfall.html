{% extends 'layout.html' %}

{% block pageTitle %}
{{ model.title }} - GOV.UK
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl govuk-!-margin-bottom-4">
      {{ model.title }}
    </h1>
    <!-- <span class="govuk-caption-m">Measured {{ model.timeElapsed }}</span> -->
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <nav aria-label="Related levels" class="govuk-!-margin-top-0">
      <span id="map"></span>
      <a href="/river-sea-groundwater-rainfall-levels?id={{ model.station.id }}" class="defra-button-secondary" role="button" data-module="govuk-button">
        Nearby levels
      </a>
    </nav>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <h2 class="govuk-visually-hidden">Station summary</h2>
    <div class="defra-flood-statistics">
      <dl class="defra-flood-statistics__list">
        <div class="defra-flood-statistics__column-one-third"> 
          <dt class="defra-flood-statistics__key">
            1 hour
          </dt>
          <dd class="defra-flood-statistics__value">
            {{ model.rainfall1hr }}mm
            <span class="defra-flood-statistics__value-detail">at {{ model.time }}</span>
          </dd>
        </div>
        <div class="defra-flood-statistics__column-one-third"> 
          <dt class="defra-flood-statistics__key">
            6 hours
          </dt>
          <dd class="defra-flood-statistics__value">
            {{ model.rainfall6hr }}mm
            <span class="defra-flood-statistics__value-detail">at {{ model.time }}</span>
          </dd>
        </div>
        <div class="defra-flood-statistics__column-one-third"> 
          <dt class="defra-flood-statistics__key">
            24 hours
          </dt>
          <dd class="defra-flood-statistics__value">
            {{ model.rainfall24hr }}mm
            <span class="defra-flood-statistics__value-detail">at {{ model.time }}</span>
          </dd>
        </div>
      </dl>
    </div>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    {# Data table #}
    <div class="defra-bar-chart">
      <table class="govuk-table defra-bar-chart__table">
        <caption class="govuk-table__caption govuk-table__caption--s govuk-!-margin-top-4">Rainfall over the last 24 hours (millimetres per hour)</caption>
        <thead class="govuk-table__head">
          <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header">Period</th>
            <th scope="col" class="govuk-table__header govuk-table__header--numeric">Accumulation</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          {% for item in model.telemetry.hourly %}
          <tr class="govuk-table__row">
            <th scope="row" class="govuk-table__header">{{ item.dateTimeHour }}</th>
            <td class="govuk-table__cell govuk-table__cell--numeric">{{ item.value }}mm</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {# Bar chart #}
      <figure class="defra-bar-chart__visualisation" style="display: none" aria-hidden="true"><!-- hidden by default, removed with js -->
        <figcaption class="govuk-heading-s govuk-!-margin-top-2 govuk-!-margin-bottom-4">Rainfall over the last 24 hours (millimetres)</figcaption>
        <div id="bar-chart" class="defra-bar-chart__container" role="presentation"></div>
      </figure>
    </div>
  </div>
</div>

{# Station Details #}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <details class="govuk-details govuk-!-margin-top-6" data-module="govuk-details">
      <summary class="govuk-details__summary">
        <span class="govuk-details__summary-text">
          View technical information
        </span>
      </summary>
      <div class="govuk-details__text">
        <dl class="govuk-summary-list govuk-summary-list--no-border govuk-summary-list--defra-flood-station govuk-!-font-size-16">
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Grid reference
            </dt>
            <dd class="govuk-summary-list__value">NY 12345 12345</dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Station name
            </dt>
            <dd class="govuk-summary-list__value">
              Gargrave
            </dd>
          </div>
          <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              Station ID
            </dt>
            <dd class="govuk-summary-list__value">
              8083
            </dd>
          </div>
        </dl>
      </div>
    </details>
    <!-- <p class="govuk-text govuk-!-margin-bottom-6">
      <a href="/how-we-measure-river-sea-groundwater-rainfall-levels">How we measure rainfall levels</a>
    </p> -->
  </div>  
</div>  

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    {% include "partials/context-footer.html" %}
    {% include "partials/related-content.html" %}
  </div>
</div>

{% endblock %}

{% block pageScripts %}
<script>
  window.flood = {
    model: {
      id: {{ model.station.id | dump | safe }},
      centroid: {{ model.station.centroid | dump | safe }},
      bingApiKey: {{ model.bingApiKey | dump | safe }},
      telemetry: {{ model.telemetry.quarterly | dump | safe }}
    }
  }
</script>
<script src="/public/javascripts/rainfall.js"></script>
{% endblock %}
